{"version":3,"file":"SwitchController.js","sources":["SwitchController.js"],"sourcesContent":["import Model from './SwitchModel';\n\nconst DEFAULT_THRESHOLD = 5;\n\nconst noop = () => { /*noop*/ };\n\nclass SwitchController {\n    constructor(updateView = noop, onChange = noop) {\n        this.handlePosition = 0;\n        this.wrapperOffset = 0;\n        this.handleOffset = 0;\n        this.handleMargin = 4;\n\n        this.updateView = updateView;\n        this.onChange = onChange;\n\n        this.change = (checked) => {\n            this.checked = checked;\n\n            this.updateView(this.updateModel(checked ? this.constrain : 0));\n\n            this.onChange(checked);\n        };\n\n        this.limit = (value) => {\n            if (value > this.constrain) {\n                return this.constrain;\n            }\n\n            if (value < 0) {\n                return 0;\n            }\n\n            return value;\n        };\n\n        this.addAnimation = (model) => {\n            if (model.transition === true) {\n                model.transition = 'all 200ms ease-out';\n            } else {\n                model.transition = 'none';\n            }\n            return model;\n        };\n\n        this.onPress = ({ pageX }) => {\n            this.lastPressX = this.originalPressX = pageX;\n        };\n\n        this.onRelease = ({ pageX }) => {\n            const delta = Math.abs(this.originalPressX - pageX);\n            const snapPoint = this.constrain / 2;\n            const checked = delta < DEFAULT_THRESHOLD ? !this.checked : this.handlePosition > snapPoint;\n\n            this.change(checked);\n        };\n\n        this.onDrag = ({ pageX }) => {\n            const { left, right } = this.coords;\n            const overElement = pageX > left && pageX < right;\n\n            if (overElement) {\n                const delta = this.reverse ? this.lastPressX - pageX : pageX - this.lastPressX;\n                const position = this.limit(this.handlePosition + delta);\n\n                this.lastPressX = pageX;\n                this.handlePosition = position;\n                this.updateView(this.updateModel(this.handlePosition));\n            }\n            if (pageX > right) {\n                this.updateView(this.updateModel(this.reverse ? 0 : this.constrain));\n            }\n\n            if (pageX < left) {\n                this.updateView(this.updateModel(this.reverse ? 0 : this.constrain));\n            }\n        };\n    }\n\n    get constrain() {\n        return this.wrapperOffset - this.handleOffset - this.handleMargin;\n    }\n\n    updateState({ wrapperOffset, handleOffset, checked, animate = true, coords, handleMargin, reverse }) {\n        this.wrapperOffset = wrapperOffset;\n        this.handleOffset = handleOffset;\n        this.coords = coords;\n        this.handleMargin = handleMargin;\n\n        this.checked = checked;\n        this.reverse = reverse;\n\n        this.updateView(this.updateModel(checked ? this.constrain : 0, animate));\n    }\n\n    updateModel(position, animate = true) {\n        let pos = this.reverse ? this.wrapperOffset / 2 - position : position;\n        return new Model(pos, animate);\n    }\n}\n\nexport default SwitchController;\n"],"names":["const","this","let"],"mappings":"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"}