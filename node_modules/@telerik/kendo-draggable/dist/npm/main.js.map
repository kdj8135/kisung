{"version":3,"file":"main.js","sources":["main.js"],"sourcesContent":["const proxy = (a, b) => (e) => b(a(e));\n\nconst bind = (el, event, callback) =>\n    el.addEventListener && el.addEventListener(event, callback);\n\nconst unbind = (el, event, callback) =>\n    el.removeEventListener && el.removeEventListener(event, callback);\n\nconst noop = () => { /* empty */ };\n\nconst touchRegExp = /touch/;\n\n// 300ms is the usual mouse interval;\n// // However, an underpowered mobile device under a heavy load may queue mouse events for a longer period.\nconst IGNORE_MOUSE_TIMEOUT = 2000;\n\nfunction normalizeEvent(e) {\n    if (e.type.match(touchRegExp)) {\n        return {\n            pageX: e.changedTouches[0].pageX,\n            pageY: e.changedTouches[0].pageY,\n            type: e.type,\n            originalEvent: e\n        };\n    }\n\n    return {\n        pageX: e.pageX,\n        pageY: e.pageY,\n        offsetX: e.offsetX,\n        offsetY: e.offsetY,\n        type: e.type,\n        ctrlKey: e.ctrlKey,\n        shiftKey: e.shiftKey,\n        altKey: e.altKey,\n        originalEvent: e\n    };\n}\n\nexport class Draggable {\n    static supportPointerEvent() {\n        return window.PointerEvent;\n    }\n\n    constructor({ press = noop, drag = noop, release = noop }) {\n        this._pressHandler = proxy(normalizeEvent, press);\n        this._dragHandler = proxy(normalizeEvent, drag);\n        this._releaseHandler = proxy(normalizeEvent, release);\n        this._ignoreMouse = false;\n        this._touchAction;\n\n        this._touchstart = (e) => {\n            if (e.touches.length === 1) {\n                this._pressHandler(e);\n            }\n        };\n\n        this._touchmove = (e) => {\n            if (e.touches.length === 1) {\n                this._dragHandler(e);\n            }\n        };\n\n        this._touchend = (e) => {\n            // the last finger has been lifted, and the user is not doing gesture.\n            // there might be a better way to handle this.\n            if (e.touches.length === 0 && e.changedTouches.length === 1) {\n                this._releaseHandler(e);\n                this._ignoreMouse = true;\n                setTimeout(this._restoreMouse, IGNORE_MOUSE_TIMEOUT);\n            }\n        };\n\n        this._restoreMouse = () => {\n            this._ignoreMouse = false;\n        };\n\n        this._mousedown = (e) => {\n            const { which } = e;\n\n            if ((which && which > 1) || this._ignoreMouse) {\n                return;\n            }\n\n            bind(document, \"mousemove\", this._mousemove);\n            bind(document, \"mouseup\", this._mouseup);\n            this._pressHandler(e);\n        };\n\n        this._mousemove = (e) => {\n            this._dragHandler(e);\n        };\n\n        this._mouseup = (e) => {\n            unbind(document, \"mousemove\", this._mousemove);\n            unbind(document, \"mouseup\", this._mouseup);\n            this._releaseHandler(e);\n        };\n\n        this._pointerdown = (e) => {\n            if (e.isPrimary) {\n                bind(this._element, \"pointermove\", this._pointermove);\n                this._touchAction = e.target.style.touchAction;\n                e.target.style.touchAction = \"none\";\n                e.target.setPointerCapture(e.pointerId);\n                this._pressHandler(e);\n            }\n        };\n\n        this._pointermove = (e) => {\n            if (e.isPrimary) {\n                this._dragHandler(e);\n            }\n        };\n\n        this._pointerup = (e) => {\n            if (e.isPrimary) {\n                unbind(this._element, \"pointermove\", this._pointermove);\n                e.target.style.touchAction = this._touchAction;\n                this._releaseHandler(e);\n            }\n        };\n    }\n\n    bindTo(element) {\n        if (element === this._element) {\n            return;\n        }\n\n        if (this._element) {\n            this._unbindFromCurrent();\n        }\n\n        this._element = element;\n\n        if (Draggable.supportPointerEvent()) {\n            bind(element, \"pointerdown\", this._pointerdown);\n            bind(element, \"pointerup\", this._pointerup);\n        } else {\n            bind(element, \"mousedown\", this._mousedown);\n            bind(element, \"touchstart\", this._touchstart);\n            bind(element, \"touchmove\", this._touchmove);\n            bind(element, \"touchend\", this._touchend);\n        }\n    }\n\n    _unbindFromCurrent() {\n        if (Draggable.supportPointerEvent()) {\n            unbind(this._element, \"pointerdown\", this._pointerdown);\n            unbind(this._element, \"pointermove\", this._pointermove);\n            unbind(this._element, \"pointerup\", this._pointerup);\n        } else {\n            unbind(this._element, \"mousedown\", this._mousedown);\n            unbind(this._element, \"touchstart\", this._touchstart);\n            unbind(this._element, \"touchmove\", this._touchmove);\n            unbind(this._element, \"touchend\", this._touchend);\n        }\n    }\n\n    destroy() {\n        this._unbindFromCurrent();\n        this._element = null;\n    }\n}\n\n// Rollup won't output exports['default'] otherwise\nexport default Draggable;\n\n"],"names":["const","this"],"mappings":"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"}