{"version":3,"file":"save-as.js","sources":["save-as.js"],"sourcesContent":["export function saveAs(data, fileName, options = {}) {\n  let save = postToProxy;\n\n  if (options.forceProxy && !options.proxyURL) {\n    throw new Error('No proxyURL is set, but forceProxy is true');\n  }\n\n  if (!options.forceProxy) {\n    if (canDownload()) {\n      save = saveAsDataURI;\n    }\n\n    if (navigator.msSaveBlob) {\n      save = saveAsBlob;\n    }\n  }\n\n  save(data, fileName, options);\n}\n\nconst anchor = () => document.createElement('a');\nconst canDownload = () => 'download' in anchor();\n\nfunction saveAsBlob(data, fileName) {\n  let blob = data; // could be a Blob object\n\n  if (typeof data === 'string') {\n    const parts = data.split(';base64,');\n    const contentType = parts[0];\n    const base64 = atob(parts[1]);\n    const array = new Uint8Array(base64.length);\n\n    for (let idx = 0; idx < base64.length; idx++) {\n      array[idx] = base64.charCodeAt(idx);\n    }\n\n    blob = new Blob([ array.buffer ], { type: contentType });\n  }\n\n  navigator.msSaveBlob(blob, fileName);\n}\n\nfunction saveAsDataURI(data, fileName) {\n  let dataURI = data;\n  if (window.Blob && data instanceof Blob) {\n    dataURI = URL.createObjectURL(data);\n  }\n\n  const fileSaver = anchor();\n  fileSaver.download = fileName;\n  fileSaver.href = dataURI;\n\n  const e = document.createEvent('MouseEvents');\n  e.initMouseEvent('click', true, false, window,\n  0, 0, 0, 0, 0, false, false, false, false, 0, null);\n\n  fileSaver.dispatchEvent(e);\n  setTimeout(() => URL.revokeObjectURL(dataURI));\n}\n\nfunction postToProxy(dataURI, fileName, options) {\n  if (!options.proxyURL) {\n    return;\n  }\n\n  const form = document.createElement('form');\n  form.setAttribute('action', options.proxyURL);\n  form.setAttribute('method', 'POST');\n  form.setAttribute('target', options.proxyTarget || '_self');\n\n  const formData = options.proxyData || {};\n  formData.fileName = fileName;\n\n  const parts = dataURI.split(\";base64,\");\n  formData.contentType = parts[0].replace(\"data:\", \"\");\n  formData.base64 = parts[1];\n\n  for (let name in formData) {\n    if (formData.hasOwnProperty(name)) {\n      const input = document.createElement('input');\n      input.setAttribute('type', 'hidden');\n      input.setAttribute('name', name);\n      input.setAttribute('value', formData[name]);\n\n      form.appendChild(input);\n    }\n  }\n\n  document.body.appendChild(form);\n  form.submit();\n  document.body.removeChild(form);\n}\n\n"],"names":["let","const"],"mappings":"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"}