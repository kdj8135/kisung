{"version":3,"file":"group.js","sources":["group.js"],"sourcesContent":["import Element from './element';\nimport Traversable from '../mixins/traversable';\nimport { append } from '../util';\nimport elementsBoundingBox from './utils/elements-bounding-box';\nimport elementsClippedBoundingBox from './utils/elements-clippend-bounding-box';\n\nclass Group extends Element {\n\n    constructor(options) {\n        super(options);\n        this.children = [];\n    }\n\n    childrenChange(action, items, index) {\n        this.trigger(\"childrenChange\",{\n            action: action,\n            items: items,\n            index: index\n        });\n    }\n\n    append() {\n        append(this.children, arguments);\n        this._reparent(arguments, this);\n\n        this.childrenChange(\"add\", arguments);\n\n        return this;\n    }\n\n    insert(index, element) {\n        this.children.splice(index, 0, element);\n        element.parent = this;\n\n        this.childrenChange(\"add\", [ element ], index);\n\n        return this;\n    }\n\n    insertAt(element, index) {\n        return this.insert(index, element);\n    }\n\n    remove(element) {\n        const index = this.children.indexOf(element);\n        if (index >= 0) {\n            this.children.splice(index, 1);\n            element.parent = null;\n            this.childrenChange(\"remove\", [ element ], index);\n        }\n\n        return this;\n    }\n\n    removeAt(index) {\n        if (0 <= index && index < this.children.length) {\n            let element = this.children[index];\n            this.children.splice(index, 1);\n            element.parent = null;\n            this.childrenChange(\"remove\", [ element ], index);\n        }\n\n        return this;\n    }\n\n    clear() {\n        const items = this.children;\n        this.children = [];\n        this._reparent(items, null);\n\n        this.childrenChange(\"remove\", items, 0);\n\n        return this;\n    }\n\n    bbox(transformation) {\n        return elementsBoundingBox(this.children, true, this.currentTransform(transformation));\n    }\n\n    rawBBox() {\n        return elementsBoundingBox(this.children, false);\n    }\n\n    _clippedBBox(transformation) {\n        return elementsClippedBoundingBox(this.children, this.currentTransform(transformation));\n    }\n\n    currentTransform(transformation) {\n        return Element.prototype.currentTransform.call(this, transformation) || null;\n    }\n\n    containsPoint(point, parentTransform) {\n        if (this.visible()) {\n            const children = this.children;\n            const transform = this.currentTransform(parentTransform);\n            for (let idx = 0; idx < children.length; idx++) {\n                if (children[idx].containsPoint(point, transform)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n    _reparent(elements, newParent) {\n        for (let i = 0; i < elements.length; i++) {\n            const child = elements[i];\n            const parent = child.parent;\n            if (parent && parent !== this && parent.remove) {\n                parent.remove(child);\n            }\n\n            child.parent = newParent;\n        }\n    }\n}\n\nGroup.prototype.nodeType = \"Group\";\n\nTraversable.extend(Group.prototype, \"children\");\n\nexport default Group;"],"names":["super","const","let","this"],"mappings":"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"}