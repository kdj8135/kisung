{"version":3,"file":"transformation.js","sources":["transformation.js"],"sourcesContent":["import ObserversMixin from '../mixins/observers-mixin';\nimport { Class } from '../common';\nimport toMatrix from './to-matrix';\nimport Matrix from './matrix';\nimport Point from './point';\n\nclass Transformation extends Class {\n\n    constructor(matrix = Matrix.unit()) {\n        super();\n\n        this._matrix = matrix;\n    }\n\n    clone() {\n        return new Transformation(\n            this._matrix.clone()\n        );\n    }\n\n    equals(other) {\n        return other &&\n               other._matrix.equals(this._matrix);\n    }\n\n    translate(x, y) {\n        this._matrix = this._matrix.multiplyCopy(Matrix.translate(x, y));\n\n        this._optionsChange();\n        return this;\n    }\n\n    scale(scaleX, scaleY = scaleX, origin = null) {\n        let originPoint = origin;\n\n        if (originPoint) {\n            originPoint = Point.create(originPoint);\n            this._matrix = this._matrix.multiplyCopy(Matrix.translate(originPoint.x, originPoint.y));\n        }\n\n        this._matrix = this._matrix.multiplyCopy(Matrix.scale(scaleX, scaleY));\n\n        if (originPoint) {\n            this._matrix = this._matrix.multiplyCopy(Matrix.translate(-originPoint.x, -originPoint.y));\n        }\n\n        this._optionsChange();\n        return this;\n    }\n\n    rotate(angle, origin) {\n        const originPoint = Point.create(origin) || Point.ZERO;\n\n        this._matrix = this._matrix.multiplyCopy(Matrix.rotate(angle, originPoint.x, originPoint.y));\n\n        this._optionsChange();\n        return this;\n    }\n\n    multiply(transformation) {\n        const matrix = toMatrix(transformation);\n\n        this._matrix = this._matrix.multiplyCopy(matrix);\n\n        this._optionsChange();\n        return this;\n    }\n\n    matrix(value) {\n        if (value) {\n            this._matrix = value;\n            this._optionsChange();\n            return this;\n        }\n\n        return this._matrix;\n    }\n\n    _optionsChange() {\n        this.optionsChange({\n            field: \"transform\",\n            value: this\n        });\n    }\n}\n\nObserversMixin.extend(Transformation.prototype);\n\nexport default Transformation;\n"],"names":["super","let","const"],"mappings":"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"}