{"version":3,"file":"measurable.js","sources":["measurable.js"],"sourcesContent":["import Matrix from '../geometry/matrix';\nimport toMatrix from '../geometry/to-matrix';\n\nconst IDENTITY_MATRIX_HASH = Matrix.IDENTITY.toString();\n\nconst Measurable = {\n    extend: function(proto) {\n        proto.bbox = this.bbox;\n        proto.geometryChange = this.geometryChange;\n    },\n\n    bbox: function(transformation) {\n        const combinedMatrix = toMatrix(this.currentTransform(transformation));\n        const matrixHash = combinedMatrix ? combinedMatrix.toString() : IDENTITY_MATRIX_HASH;\n        let bbox;\n\n        if (this._bboxCache && this._matrixHash === matrixHash) {\n            bbox = this._bboxCache.clone();\n        } else {\n            bbox = this._bbox(combinedMatrix);\n            this._bboxCache = bbox ? bbox.clone() : null;\n            this._matrixHash = matrixHash;\n        }\n\n        const strokeWidth = this.options.get(\"stroke.width\");\n        if (strokeWidth && bbox) {\n            bbox.expand(strokeWidth / 2);\n        }\n\n        return bbox;\n    },\n\n    geometryChange: function() {\n        delete this._bboxCache;\n        this.trigger(\"geometryChange\", {\n            element: this\n        });\n    }\n};\n\nexport default Measurable;"],"names":["const","let"],"mappings":"AAAA,OAAO,MAAM,MAAM,oBAAoB,CAAC;AACxC,OAAO,QAAQ,MAAM,uBAAuB,CAAC;;AAE7CA,GAAK,CAAC,oBAAoB,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;;AAExDA,GAAK,CAAC,UAAU,GAAG;IACf,MAAM,EAAE,SAAS,KAAK,EAAE;QACpB,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;QACvB,KAAK,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC;KAC9C;;IAED,IAAI,EAAE,SAAS,cAAc,EAAE;QAC3BA,GAAK,CAAC,cAAc,GAAG,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC,CAAC;QACvEA,GAAK,CAAC,UAAU,GAAG,cAAc,GAAG,cAAc,CAAC,QAAQ,EAAE,GAAG,oBAAoB,CAAC;QACrFC,GAAG,CAAC,IAAI,CAAC;;QAET,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,WAAW,KAAK,UAAU,EAAE;YACpD,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;SAClC,MAAM;YACH,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;YAClC,IAAI,CAAC,UAAU,GAAG,IAAI,GAAG,IAAI,CAAC,KAAK,EAAE,GAAG,IAAI,CAAC;YAC7C,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;SACjC;;QAEDD,GAAK,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;QACrD,IAAI,WAAW,IAAI,IAAI,EAAE;YACrB,IAAI,CAAC,MAAM,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC;SAChC;;QAED,OAAO,IAAI,CAAC;KACf;;IAED,cAAc,EAAE,WAAW;QACvB,OAAO,IAAI,CAAC,UAAU,CAAC;QACvB,IAAI,CAAC,OAAO,CAAC,gBAAgB,EAAE;YAC3B,OAAO,EAAE,IAAI;SAChB,CAAC,CAAC;KACN;CACJ,CAAC;;AAEF,eAAe,UAAU"}