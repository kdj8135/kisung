{"version":3,"file":"wrap-elements.js","sources":["wrap-elements.js"],"sourcesContent":["import translateToPoint from './translate-to-point';\nimport stackElements from './stack-elements';\n\nfunction getStacks(elements, rect, sizeField) {\n    const maxSize = rect.size[sizeField];\n    const stacks = [];\n    let stack = [];\n    let stackSize = 0;\n    let element, bbox;\n\n    const addElementToStack = function() {\n        stack.push({\n            element: element,\n            bbox: bbox\n        });\n    };\n\n    for (let idx = 0; idx < elements.length; idx++) {\n        element = elements[idx];\n\n        bbox = element.clippedBBox();\n        if (bbox) {\n            let size = bbox.size[sizeField];\n            if (stackSize + size > maxSize) {\n                if (stack.length) {\n                    stacks.push(stack);\n                    stack = [];\n                    addElementToStack();\n                    stackSize = size;\n                } else {\n                    addElementToStack();\n                    stacks.push(stack);\n                    stack = [];\n                    stackSize = 0;\n                }\n            } else {\n                addElementToStack();\n                stackSize += size;\n            }\n        }\n    }\n\n    if (stack.length) {\n        stacks.push(stack);\n    }\n\n    return stacks;\n}\n\nexport default function wrapElements(elements, rect, axis, otherAxis, sizeField) {\n    const stacks = getStacks(elements, rect, sizeField);\n    const origin = rect.origin.clone();\n    const result = [];\n\n    for (let idx = 0; idx < stacks.length; idx++) {\n        let stack = stacks[idx];\n        let startElement = stack[0];\n        origin[otherAxis] = startElement.bbox.origin[otherAxis];\n        translateToPoint(origin, startElement.bbox, startElement.element);\n        startElement.bbox.origin[axis] = origin[axis];\n        stackElements(stack, axis, otherAxis, sizeField);\n        result.push([]);\n        for (let elementIdx = 0; elementIdx < stack.length; elementIdx++) {\n            result[idx].push(stack[elementIdx].element);\n        }\n    }\n    return result;\n}"],"names":["const","let"],"mappings":"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"}