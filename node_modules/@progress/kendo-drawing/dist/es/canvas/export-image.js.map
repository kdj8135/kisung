{"version":3,"file":"export-image.js","sources":["export-image.js"],"sourcesContent":["import Surface from './surface';\nimport { transform } from '../geometry';\nimport Group from '../shapes/group';\n\nexport default function exportImage(group, options) {\n    const defaults = {\n        width: \"800px\", height: \"600px\",\n        cors: \"Anonymous\"\n    };\n\n    let exportRoot = group;\n    const bbox = group.clippedBBox();\n\n\n    if (bbox) {\n        const origin = bbox.getOrigin();\n        exportRoot = new Group();\n        exportRoot.transform(transform().translate(-origin.x, -origin.y));\n        exportRoot.children.push(group);\n\n        const size = bbox.getSize();\n        defaults.width = size.width + \"px\";\n        defaults.height = size.height + \"px\";\n    }\n\n    const surfaceOptions = Object.assign(defaults, options);\n\n    const container = document.createElement(\"div\");\n    const style = container.style;\n\n    style.display = \"none\";\n    style.width = surfaceOptions.width;\n    style.height = surfaceOptions.height;\n    document.body.appendChild(container);\n\n    const surface = new Surface(container, surfaceOptions);\n    surface.suspendTracking();\n    surface.draw(exportRoot);\n\n    const promise = surface.image();\n    const destroy = () => {\n        surface.destroy();\n        document.body.removeChild(container);\n    };\n    promise.then(destroy, destroy);\n\n    return promise;\n}"],"names":["const","let"],"mappings":"AAAA,OAAO,OAAO,MAAM,WAAW,CAAC;AAChC,SAAS,SAAS,QAAQ,aAAa,CAAC;AACxC,OAAO,KAAK,MAAM,iBAAiB,CAAC;;AAEpC,eAAe,SAAS,WAAW,CAAC,KAAK,EAAE,OAAO,EAAE;IAChDA,GAAK,CAAC,QAAQ,GAAG;QACb,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,OAAO;QAC/B,IAAI,EAAE,WAAW;KACpB,CAAC;;IAEFC,GAAG,CAAC,UAAU,GAAG,KAAK,CAAC;IACvBD,GAAK,CAAC,IAAI,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;;;IAGjC,IAAI,IAAI,EAAE;QACNA,GAAK,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAChC,UAAU,GAAG,IAAI,KAAK,EAAE,CAAC;QACzB,UAAU,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC,SAAS,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QAClE,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;QAEhCA,GAAK,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QAC5B,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QACnC,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;KACxC;;IAEDA,GAAK,CAAC,cAAc,GAAG,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;;IAExDA,GAAK,CAAC,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IAChDA,GAAK,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;;IAE9B,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;IACvB,KAAK,CAAC,KAAK,GAAG,cAAc,CAAC,KAAK,CAAC;IACnC,KAAK,CAAC,MAAM,GAAG,cAAc,CAAC,MAAM,CAAC;IACrC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;;IAErCA,GAAK,CAAC,OAAO,GAAG,IAAI,OAAO,CAAC,SAAS,EAAE,cAAc,CAAC,CAAC;IACvD,OAAO,CAAC,eAAe,EAAE,CAAC;IAC1B,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;;IAEzBA,GAAK,CAAC,OAAO,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC;IAChCA,GAAK,CAAC,OAAO,GAAG,SAAA,GAAG,AAAG;QAClB,OAAO,CAAC,OAAO,EAAE,CAAC;QAClB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;KACxC,CAAC;IACF,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;;IAE/B,OAAO,OAAO,CAAC;"}